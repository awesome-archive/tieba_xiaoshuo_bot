{"tagline":"自动抓百度贴吧置顶的小说章节更新，并推送手机版式的贴吧链接到 gtalk 客户端(理论支持所有 XMPP 聊天服务)","body":"Howto?\r\n=====\r\n\r\n1. `yum install postgresql-devel libxslt-devel postgresql-server libxml2-devel`\r\n1. `bundle install`\r\n2. 改名 `mv config/config.yml{.example,}`\r\n3. 填上自己的信息（ **数据库使用 `Sequel` 作为 ORM gem** ）\r\n4. `rake migration`\r\n5. `bundle exec foreman start`\r\n\r\nFetch Rules?\r\n============\r\n\r\n* 每五分钟扫描一遍对应小说贴吧的置顶帖，如果扫到包含 *第xxx章*\r\n  字样的就认定是更新的小说章节，然后发给订阅者\r\n* 依赖百度贴吧的“置顶贴”，严重感谢贴吧吧务们\r\n\r\nTry?\r\n====\r\n\r\n* 用 Gtalk 加好友 `crhan.xiaoshuo@gmail.com`\r\n* 发送 `-?` 给机器人查看帮助\r\n* 发送 `-sub 小说名字` 即可订阅小说\r\n\r\nCommands\r\n========\r\n\r\n* -c/-check: 在 __被动__ 模式下查看积累的更新\r\n* -s/-sub <小说名>: 订阅小说(请先检查对应贴吧是否有小说更新服务)\r\n* -us/-unsub <小说名>: 退订已订阅的小说\r\n* -sm/-switch_mode: 在 __主动__ 和 __被动__ 推送模式之间切换\r\n* -m/-show_mode: 看看自己是在主动模式还是被动模式\r\n* -h/-?/-help: 查看帮助\r\n* -l/-ls/-list: 查看已订阅(包括已退订)的小说\r\n* -fb/-feedback: 给我提意见啦\r\n* -ab/-about: 无聊卖萌(女神提供的台词)\r\n* -co/-count: 看看我已经发给你多少章小说啦\r\n\r\n---------\r\n\r\n# Change Log\r\n\r\n## 1.3.3 / 2012-09-02 \r\n\r\n  * 修正无法获得小说贴吧列表的问题  - 来自百度贴吧的奇怪更新, 如果在请求头中没有附带 BAIDUID 的 cookie 的话会导致 301 跳转\r\n  * 修正 unsub 的方法重构后没有对应调整 worker 方法\r\n\r\n## 1.3.2 / 2012-08-24 \r\n\r\n  * 恢复五分钟一次在线检测\r\n  * 修复 count 命令错误\r\n  * 百度贴吧改版, 修改DOM搜索规则\r\n\r\n## 1.3.1 / 2012-08-16 \r\n\r\n  * bugs fixed\r\n\r\n## 1.3.0 / 2012-08-14 \r\n\r\n  * 增加 Fiction::name 的 unique 限制\r\n  * 使用 simplecov 作为测试覆盖率工具\r\n  * 分离 _测试_ 和 _发布_ 环境的数据库配置\r\n  * 重构 worker/send.rb, model/user.rb, model/fiction.rb\r\n  * 增加测试代码, 测试样本数据\r\n  * 修复 migration 错误\r\n\r\n## 1.2.4 / 2012-07-31 \r\n\r\n  * 重构 bot.rb 并添加了短命令\r\n  * Bot 不再使用单例模式, 并且尝试掉线后自动重连并重试发送\r\n  * handle `Jabber::ServerDisconnected` and log it\r\n  * Error log will log the hooked user now\r\n\r\n## 1.2.3 / 2012-07-23 \r\n\r\n  * 切换模式命令改为 `-switch`, 查看模式为 `-mode`\r\n\r\n## 1.2.2 / 2012-07-21 \r\n\r\n  * 修复无法在 send.rb 中 Subscription.update(:check_id => last_id) 的问题\r\n\r\n## 1.2.1 / 2012-07-21 \r\n\r\n  * 修复 worker/send.rb:45 的 send NilClass 问题\r\n\r\n## 1.2.0 / 2012-07-20 \r\n\r\n  * model 的 before_create 和 before_save 改为 mixin 形式混入. 正常 model 直接继承 Sequel::Model\r\n  * 加入等待, 确保在 `-check` 时候小说按照顺序分发\r\n  * 增加 `check` 模式和 `-check` 命令 使用 `-mode` 切换模式\r\n  * 增加 `-count` 命令\r\n\r\n## 1.1.0 / 2012-07-13 \r\n\r\n  * 增加gtalk XMPP extension 属性, 默认保存消息历史到 gtalk 服务器\r\n\r\n## 1.0.6 / 2012-06-26 \r\n\r\n  * 修复 1.0.3 引入的重复章节检测的 Typo\r\n\r\n## 1.0.5 / 2012-06-25 \r\n\r\n  * IQ 查询并发导致 users 重复创建, 在数据库上增加 unique 限制\r\n\r\n## 1.0.4 / 2012-06-25 \r\n\r\n  * 修正由于 Typo 导致的 Bot 崩溃\r\n\r\n## 1.0.3 / 2012-06-25 \r\n\r\n  * 章节名重复检测有误, 修正\r\n\r\n## 1.0.2 / 2012-06-24 \r\n\r\n  * 失误：改了 rack 的配置文件名却没改 `Prockfile` 的配置\r\n\r\n\r\n## 1.0.1 / 2012-06-24 \r\n\r\n  * gtalk 密码分离到 config/config.yml 配置文件 准备开源\r\n\r\n## 1.0.0 / 2012-06-24 \r\n\r\n  * 自动添加现有好友到数据库\r\n  * 检测重复章节名（一般是因为前一贴被删才有新的同名贴) 优化章节名(去除第一个“第”之前的文字，并且多个空格和并成一个)\r\n  * 增加 `-list`, `-sub`, `-unsub`, `-help`, `-about`, `-feedback` 命令\r\n  * 使用 `Sidekiq` 作为队列实现\r\n  * 使用 `Sequel` 作为 ORM 组件\r\n  * 使用 `PostgreSQL` 做数据存储\r\n  * REXML bug fix: 使用\r\n  \t[ xmpp4r/issues/3 ]( https://github.com/ln/xmpp4r/issues/3#issuecomment-1739952 ) 补丁使 REXML 能正确处理 UTF 字符\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration.","name":"百度贴吧小说推送机器人"}